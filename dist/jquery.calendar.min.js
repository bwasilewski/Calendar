/*
 *  jquery-calendar - v1.0.0
 *  A simple jquery Calendar plugin.
 *  http://benwas.com
 *
 *  Made by Benjamin Wasilewski
 *  Under MIT License
 */
!function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.settings=a.extend({},j,c),this._defaults=j,this._name=f,this.init()}var f="Calendar",g=new Date,h=new Date,i=["January","February","March","April","May","June","July","August","September","October","November","December"],j={calendarHeaderAttributes:{class:"dayLabels"},cellAttributes:{class:"dateCell"},containerAttrs:{class:"calendar-container"},message:"New jQuery Plugin!",monthSelectorAttributes:{class:"month-selector"},nextMonthClassName:"next",nextMonthSelector:".next",nextButtonText:"Next",onCellClick:function(){},onNextMonthClick:function(){},onPreviousMonthClick:function(){},previousMonthClassName:"prev",previousMonthSelector:".prev",previousButtonText:"Previous",rowAttributes:{class:"calendar-row"},selectedDate:h,tableAttributes:{class:"calendar-table"},textFieldAttributes:{type:"hidden",class:"calendar-date-field"},yearSelectorAttributes:{class:"year-selector"}};a.extend(e.prototype,{init:function(){var b=this;this.calendarDate=new Date,this.todaysDate=new Date,this.date=this.calendarDate.getDate(),this.day=this.calendarDate.getDay(),this.month=this.calendarDate.getMonth(),this.year=this.calendarDate.getFullYear(),this.container=a("<div />"),this.calendarHeader=a("<thead />",this.settings.calendarHeaderAttributes).html("<tr><th>S</th><th>M</th><th>T</th><th>W</th><th>T</th><th>F</th><th>S</th></tr>"),this.selectors=a("<form />",{class:"selectors"}),this.monthSelector=a("<select />",this.settings.monthSelectorAttributes),this.yearSelector=a("<select />",this.settings.yearSelectorAttributes),this.table=a("<table />",this.settings.tableAttributes),this.row=a("<tr />",this.settings.rowAttributes),this.rows=[],this.cell=a("<td />",this.settings.cellAttributes).html("<span></span>"),this.textfield=a("<input />",this.settings.textFieldAttributes),this.nextButton=a("<button />",{class:b.settings.nextMonthClassName}).html(b.settings.nextButtonText),this.previousButton=a("<button />",{class:b.settings.previousMonthClassName}).html(b.settings.previousButtonText),this.container.attr(this.settings.containerAttrs).appendTo(this.element),this.previousButton.appendTo(this.container),this.selectors.appendTo(this.container),this.monthSelector.appendTo(this.selectors),this.yearSelector.appendTo(this.selectors),this.nextButton.appendTo(this.container),this.table.appendTo(this.container),this.calendarHeader.appendTo(this.table),this.textfield.appendTo(this.container),this.populateSelectors(),this.selectDate(this.settings.selectedDate),this.bindEvents()},bindEvents:function(){var b=this;this.nextButton.bind("click",{context:this},this.handleNextBtn),this.previousButton.bind("click",{context:this},this.handlePreviousBtn),a([this.monthSelector,this.yearSelector]).each(function(a,c){c.bind("change",{context:b},b.handleSelectors)}),this.bindCellEvents()},bindCellEvents:function(){a(this.cells,this.element).unbind("click"),a(this.cells,this.element).bind("click",{context:this},this.handleCellClick)},handleNextBtn:function(a){var b=a.data.context,c=11===b.month?0:b.month+1,d=11===b.month?b.year+1:b.year;b.updateCalendar(b.element,c,d),b.settings.onNextMonthClick(a)},handlePreviousBtn:function(a){var b=a.data.context,c=0===b.month?11:b.month-1,d=0===b.month?b.year-1:b.year;b.updateCalendar(b.element,c,d),b.settings.onPreviousMonthClick(a)},handleSelectors:function(a){var b=a.data.context,c=parseFloat(b.monthSelector.find("option:selected").attr("value")),d=parseFloat(b.yearSelector.find("option:selected").attr("value"));b.updateCalendar(b.element,c,d)},handleCellClick:function(b){var c=b.data.context;a.each(c.cells,function(b,c){a(c).removeClass("selected")}),a(this).addClass("selected"),c.selectedDate=a(this),c.updateTextField(a(this).data()),c.settings.onCellClick(b)},drawCalendar:function(){var b=this;this.cells=[],this.rows=[],this.table.find("tr").remove();for(var c=0;c<6;c++)this.rows.push(this.row.clone().appendTo(this.table));a.each(this.rows,function(a,c){for(var d=0;d<7;d++){var e=b.cell.clone().appendTo(c);b.cells.push(e[0])}}),this.createDateArray()},createDateArray:function(){var b=[],c=this.getFirstDay(this.month,this.year),d=this.daysInMonth(this.month,this.year),e=this.month>0?this.month-1:11,f=this.month>0?this.year:this.year-1,g=this.daysInMonth(e,f),h=0,i=a(this.cells,this.element),j=a(this.rows,this.element),k=i.length,l=0,m=this;h=0===c?g-6:g-(c-1),h=0===c?g-6:g-(c-1);for(var n=h;n<=g;n++)b.push({date:n,month:m.month-1,year:m.month>0?m.year:m.year-1,className:"calendar-previous-date"}),h++;for(var o=1;o<=d;o++)b.push({date:o,month:m.month,year:this.year,className:"calendar-current-date"});l=k-b.length;for(var p=1;p<=l;p++)b.push({date:p,month:m.month+1,year:m.month<11?m.year:m.year+1,className:"calendar-post-date"});a.each(i,function(c,d){var e=a(d),f=b[c];e.attr("class",m.settings.cellAttributes.class+" "+f.className).html("<span>"+f.date+"</span>").attr({"data-date":f.date,"data-month":f.month,"data-year":f.year}).data(f)}),a.each(j,function(b,c){var d=a(c).find("td"),e=0;a.each(d,function(b,c){a(c).hasClass("calendar-current-date")&&e++}),0===e&&a(c).addClass("calendar-empty-row")})},getFirstDay:function(a,b){var c=new Date;return c.setFullYear(b),c.setMonth(a),c.setDate(1),c.getDay()},daysInMonth:function(a,b){return 32-new Date(b,a,32).getDate()},populateSelectors:function(){for(var b=this.monthSelector,c=this.yearSelector,d=this.year-20,e=this.year+20,f=d;f<e;f++)c.append('<option value="'+f+'">'+f+"</option>"),f===this.year&&c.find("option").last().attr("selected","selected");a.each(i,function(a,c){b.append('<option value="'+a+'">'+c+"</option>")}),this.updateSelectors(this.month,this.year)},updateSelectors:function(a,b){this.monthSelector.val(a),this.yearSelector.val(b)},updateCalendar:function(a,b,c){this.month=b,this.year=c,g.setMonth(b),g.setFullYear(c),this.drawCalendar(a,b,c),this.updateSelectors(b,c),this.bindCellEvents()},getOrdinal:function(a){var b=["th","st","nd","rd"],c=a%100;return a+(b[(c-20)%10]||b[c]||b[0])},getSelectedDate:function(){return{el:this.selectedDate}},selectDate:function(b){var c,d=b.getDate(),e=b.getMonth(),f=b.getFullYear();this.updateCalendar(this.element,e,f),c=a('td[data-date="'+d+'"][data-month="'+e+'"]',this.element),c.click()},updateTextField:function(a){this.textfield.val(a.month+"/"+a.date+"/"+a.year)}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);